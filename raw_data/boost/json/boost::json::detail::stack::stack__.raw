push rbx
mov rsi, qword [rdi + 0x18]
mov rbx, rdi
mov rdi, qword [rdi]
test rsi, rsi
je 0x800a8b7
mov rax, rdi
mov rdx, qword [rbx + 8]
mov ecx, 0x10
and rax, 0xfffffffffffffffc
test rdi, rdi
lea rdi, [0x0800a8aa]
cmovne rdi, rax
mov rax, qword [rdi]
call qword [rax + 0x18]
mov rdi, qword [rbx]
test dil, 1
jne 0x800a8c0
pop rbx
ret
nop
and rdi, 0xfffffffffffffffc
lock sub qword [rdi + 8], 1
jne 0x800a8bd
test rdi, rdi
je 0x800a8bd
mov rax, qword [rdi]
pop rbx
mov rax, qword [rax + 8]
jmp rax
