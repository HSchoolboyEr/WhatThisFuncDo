push r13
push r12
mov r12, rdi
push rbp
lea r13, [r12 + 0x10]
push rbx
mov rbx, rsi
mov esi, 0x400
sub rsp, 0x408
mov rbp, rsp
mov rdi, rbp
call gethostname
test eax, eax
jne __errno_location
mov dword [rbx], 0
mov rdi, rbp
mov qword [rbx + 8], 0
mov qword [rbx + 0x10], 0
mov qword [r12], r13
call strlen
mov rsi, rbp
mov rdi, r12
lea rdx, [rbp + rax]
call .text
add rsp, 0x408
mov rax, r12
pop rbx
pop rbp
pop r12
pop r13
ret
nop
call __errno_location
lea rcx, [0x0800c6ec]
mov eax, dword [rax]
mov qword [rbx + 8], rcx
mov dword [rbx], eax
cmp eax, 1
mov eax, 2
sbb rax, 0xffffffffffffffff
mov qword [rbx + 0x10], rax
mov qword [r12], r13
mov qword [r12 + 8], 0
mov byte [r12 + 0x10], 0
jmp 0x800c6ce
