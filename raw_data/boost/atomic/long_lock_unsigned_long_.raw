push r12
movzx r12d, dil
lea rdi, [0x0800044d]
mov ecx, 0xa
shl r12, 6
add r12, rdi
mov eax, dword [r12]
test al, 1
jne 0x8000478
mov edx, eax
or edx, 1
lock cmpxchg dword [r12], edx
jne 0x8000478
mov rax, r12
pop r12
ret
nop dword [rax]
pause
sub ecx, 1
jne 0x8000459
mov eax, dword [r12]
test al, 1
jne 0x80004a0
mov edx, eax
or edx, 1
lock cmpxchg dword [r12], edx
jne 0x8000483
mov rax, r12
pop r12
ret
nop word [rax + rax]
mov ecx, eax
or ecx, 2
lock cmpxchg dword [r12], ecx
jne 0x8000483
sub rsp, 8
mov edx, 0x80
xor r9d, r9d
xor r8d, r8d
push 0
mov rsi, r12
mov edi, 0xca
xor eax, eax
call syscall
mov eax, dword [r12]
pop rdx
pop rcx
jmp 0x8000483
