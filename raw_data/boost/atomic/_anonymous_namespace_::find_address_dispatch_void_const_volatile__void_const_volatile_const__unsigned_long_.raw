mov r8, rsi
xor esi, esi
push rbx
mov r9, rdx
mov eax, esi
mov ebx, esi
mov ecx, esi
mov edx, esi
cpuid
lea r10, [0x0800009a]
add byte [rax], al
add byte [rax], al
test eax, eax
je 0x80000c9
mov eax, 1
mov ebx, esi
mov ecx, esi
mov edx, esi
cpuid
and edx, 0x4000000
je 0x80000ba
mov r10, qword [0x080000ba]
and ecx, 0x80000
je 0x80000c9
mov r10, qword [0x080000c9]
mov qword [0x080000d0], r10
mov rdx, r9
mov rsi, r8
pop rbx
jmp r10
